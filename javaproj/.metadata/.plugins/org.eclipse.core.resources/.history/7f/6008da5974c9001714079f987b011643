package szpital;

import java.util.Scanner;

public class App {
	Scanner rl;
	DB db;
	
	private String menu(String[] options){
		System.out.println("Dostêpne opcje:");
		for (String option : options){
			System.out.println(option);
		}		
		return rl.nextLine();
		
	}
		
	App(){
		rl=Tools.In();
		
		db=DB.createDBConnection("jdbc:mysql://localhost:3306/szpital?useSSL=false"
				               , "root"
				               , "root");
		System.out.print("£¹czenie z baz¹ danych...");
		if (db==null) {
			System.out.println("B³¹d, wyjœcie z programu");
			return;
		}
		System.out.println("OK");
		
		Lekarze L=new Lekarze(db,rl);
		Pacjenci P=new Pacjenci(db,rl);
		
		String menulevel="M";
		String[] mainoptions={"EXIT, Q, ! -Wyjœcie","L-lekarze","P-pacjenci"};
		String[] lekarzeoptions={"LL-Lista lekarzy","DL-Dodawanie lekarza","UL-usuwanie lekarza","M-powrót do menu g³ownego"};
		String[] pacjencioptions={"LP-Lista pacjentów","DP-Dodawanie pacjenta","M-powrót do menu g³ownego"};
		boolean exit=false;
		String w;
		String[] m={};
		
		do {
			
			switch (menulevel){
			case "M":m=mainoptions;break;
			case "L":m=lekarzeoptions;break;
			case "P":m=pacjencioptions;break;
			}; 
			w=this.menu(m).toUpperCase();
			
			switch(w){
			case "EXIT":   
			case "!": 
			case "Q": exit=true;break;
			case "M": menulevel="M"; break;
			case "L": menulevel="L"; break;
			case "P": menulevel="P"; break;
			
			case "DL": L.ask_add(); break;
			case "UL": L.ask_del(); break;
			case "LL": System.out.println(L);break;
			
			case "DP": P.ask_add(); break;			
			case "LP": System.out.println(P);break;
			
			default: System.out.println("Komenda nierozpoznana, spróbuj ponownie!"); break;
			}
		} while (!exit);
		
		db.closeConnection();
		rl.close();
		
		System.out.println("Koniec programu");
		
	}

	public static void main(String[] args) {
		new App();			
	}

}
